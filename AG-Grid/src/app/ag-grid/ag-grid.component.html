<div class="container mt-3">
  <div class="d-flex justify-content-between align-items-center mb-3">
    <div class="form-check form-switch">
      <input
        class="form-check-input"
        type="checkbox"
        role="switch"
        id="flexSwitchCheckChecked"
        [(ngModel)]="isDrakMode"
      />
      <label class="form-check-label ms-2" for="flexSwitchCheckChecked">
        Dark Mode
      </label>
    </div>

    <div class="w-40">
      <button type="button" class="btn btn-success" (click)="exportToExcel()">
        Export To Excel
      </button>
    </div>

    <div class="w-50">
      <input
        type="text"
        class="form-control"
        placeholder="Search all columns..."
        [(ngModel)]="searchText"
        (ngModelChange)="onSearchChange($event)"
      />
    </div>
  </div>

  <!-- AG Grid -->
  <div
    class="row justify-content-center"
    [ngClass]="
      isDrakMode ? 'ag-theme-alpine-dark' : 'ag-theme-alpine data-grid'
    "
  >
    <div class="col-12">
      <ag-grid-angular
        class="grid-full-size"
        [rowData]="rowData"
        [columnDefs]="columnDefs"
        [defaultColDef]="{ resizable: true, sortable: true, filter: true }"
        (cellValueChanged)="onCellValueChanged($event)"
        [gridOptions]="gridOptions"
        (gridReady)="onGridReady($event)"
        [quickFilterText]="searchText"
        [autoGroupColumnDef]="autoGroupColumnDef"
        [groupDefaultExpanded]="groupDefaultExpanded"
        [domLayout]="'autoHeight'"
        (rowDragMove)="onRowDragMove($event)"
      >
      </ag-grid-angular>
    </div>
  </div>
</div>
